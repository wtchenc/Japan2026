<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 日本旅行手帳</title>
    
    <!-- Google Fonts: Zen Maru Gothic (圓體) & Noto Sans TC -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700&family=Noto+Sans+TC:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Tailwind Config for Journal Style -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        journal: {
                            bg: '#fcf9f2',      // 米黃紙張底色
                            card: '#ffffff',    // 純白紙張
                            ink: '#594a4e',     // 深褐墨水色 (文字主色)
                            brown: '#a68a80',   // 淺棕色 (次要文字)
                            accent: '#d48872',  // 珊瑚粉 (強調色)
                            blue: '#8db5be',    // 沖繩海藍
                            green: '#9eb896',   // 九州山綠
                            line: '#e0d8cc'     // 淺灰線條
                        }
                    },
                    fontFamily: {
                        sans: ['"Zen Maru Gothic"', '"Noto Sans TC"', 'sans-serif'],
                    },
                    backgroundImage: {
                        'paper-pattern': "url('data:image/svg+xml,%3Csvg width=\\'60\\' height=\\'60\\' viewBox=\\'0 0 60 60\\' xmlns=\\'http://www.w3.org/2000/svg\\'%3E%3Cg fill=\\'none\\' fill-rule=\\'evenodd\\'%3E%3Cg fill=\\'%23d1c7b7\\' fill-opacity=\\'0.15\\'%3E%3Cpath d=\\'M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z\\'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')",
                    }
                }
            }
        }
    </script>

    <style>
        /* Global Reset & Utility */
        body {
            background-color: #fcf9f2;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23dcbba3' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
            color: #594a4e;
            -webkit-tap-highlight-color: transparent;
        }
        
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Journal Card Effect */
        .journal-card {
            background: #fff;
            border-radius: 12px;
            box-shadow: 2px 3px 10px rgba(0,0,0,0.05);
            border: 1px solid rgba(0,0,0,0.02);
            position: relative;
        }

        /* Washi Tape Effect */
        .washi-tape-top {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%) rotate(-1deg);
            width: 100px;
            height: 24px;
            background-color: rgba(212, 136, 114, 0.3);
            border-left: 2px dashed rgba(255,255,255,0.6);
            border-right: 2px dashed rgba(255,255,255,0.6);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            z-index: 10;
        }
        .washi-tape-blue { background-color: rgba(141, 181, 190, 0.4); }
        .washi-tape-green { background-color: rgba(158, 184, 150, 0.4); }

        /* Dashed Timeline */
        .timeline-line::before {
            content: '';
            position: absolute;
            top: 2rem;
            bottom: -1rem;
            left: 1rem;
            width: 0px;
            border-left: 2px dashed #d1c7b7;
            z-index: 0;
        }
        .last-item .timeline-line::before { display: none; }

        /* Hand-drawn Button */
        .btn-hand {
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
        }
        .btn-hand:active {
            transform: translateY(2px);
            border-bottom: 0px solid transparent;
        }

        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="flex flex-col h-screen overflow-hidden text-journal-ink">

    <!-- Top Header -->
    <header id="main-header" class="flex-none bg-journal-bg/95 backdrop-blur-sm border-b border-journal-line px-6 py-4 flex justify-between items-center z-20 transition-transform duration-300">
        <div>
            <h1 class="text-2xl font-bold tracking-widest text-journal-ink flex items-center">
                <i class="fa-solid fa-plane-up mr-2 text-journal-accent text-sm"></i>
                TRIP 2026
            </h1>
            <p class="text-xs text-journal-brown tracking-wider mt-1">
                <span class="bg-journal-blue/20 px-2 py-0.5 rounded-full text-journal-blue">沖繩</span> & 
                <span class="bg-journal-green/20 px-2 py-0.5 rounded-full text-journal-green">九州</span>
            </p>
        </div>
        <div class="flex flex-col items-end">
            <div class="text-xs text-journal-brown mb-1">Day</div>
            <div class="text-xl font-bold text-journal-accent font-mono bg-white px-3 py-1 rounded-lg border-2 border-dashed border-journal-line shadow-sm">
                <span id="current-day-display">1</span>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main id="app-container" class="flex-1 overflow-y-auto hide-scrollbar p-4 pb-28 relative">
        <!-- Content injected by JS -->
    </main>

    <!-- Bottom Navigation (Floating) -->
    <div class="fixed bottom-6 left-4 right-4 z-30">
        <nav class="bg-white rounded-2xl shadow-[0_5px_20px_rgba(0,0,0,0.08)] border border-journal-line p-1.5 flex justify-around items-center">
            <button onclick="switchTab('plan')" class="nav-btn w-full py-3 rounded-xl flex flex-col items-center justify-center space-y-1 text-journal-brown transition-colors hover:bg-journal-bg" data-target="plan">
                <i class="fa-regular fa-calendar-check text-lg"></i>
                <span class="text-[10px] font-medium">行程</span>
            </button>
            <button onclick="switchTab('guide')" class="nav-btn w-full py-3 rounded-xl flex flex-col items-center justify-center space-y-1 text-journal-brown transition-colors hover:bg-journal-bg" data-target="guide">
                <i class="fa-solid fa-book-open text-lg"></i>
                <span class="text-[10px] font-medium">景點</span>
            </button>
            <button onclick="switchTab('shops')" class="nav-btn w-full py-3 rounded-xl flex flex-col items-center justify-center space-y-1 text-journal-brown transition-colors hover:bg-journal-bg" data-target="shops">
                <i class="fa-solid fa-shop text-lg"></i>
                <span class="text-[10px] font-medium">好店</span>
            </button>
            <button onclick="switchTab('lists')" class="nav-btn w-full py-3 rounded-xl flex flex-col items-center justify-center space-y-1 text-journal-brown transition-colors hover:bg-journal-bg" data-target="lists">
                <i class="fa-solid fa-list-check text-lg"></i>
                <span class="text-[10px] font-medium">清單</span>
            </button>
            <button onclick="switchTab('info')" class="nav-btn w-full py-3 rounded-xl flex flex-col items-center justify-center space-y-1 text-journal-brown transition-colors hover:bg-journal-bg" data-target="info">
                <i class="fa-solid fa-circle-info text-lg"></i>
                <span class="text-[10px] font-medium">資訊</span>
            </button>
        </nav>
    </div>

    <!-- Modal -->
    <div id="loading-modal" class="hidden fixed inset-0 bg-journal-ink/20 z-50 flex items-center justify-center backdrop-blur-sm">
        <div class="bg-white p-6 rounded-2xl shadow-xl flex flex-col items-center space-y-3">
            <i class="fa-solid fa-circle-notch fa-spin text-journal-accent text-2xl"></i>
            <span class="text-journal-ink font-medium">處理中...</span>
        </div>
    </div>

    <script>
        // --- Data ---
        const tripData = [
            {
                date: "01/28 (三)",
                title: "Day 1: 抵達沖繩 & 居酒屋體驗",
                area: "沖繩那霸",
                route: "https://www.google.com/maps/dir/Naha+Airport/THE+NEST+HOTEL+NAHA/Mikado+Naha/Steak+House+88+Tsuji",
                mapFocus: "Mikado Naha",
                events: [
                    { time: "19:20", title: "抵達那霸機場 (OKA)", desc: "搭計程車前往飯店 (約20分)", icon: "fa-plane-arrival", highlight: true },
                    { time: "20:30", title: "Check-in THE NEST", desc: "放行李", icon: "fa-hotel" },
                    { time: "晚餐", title: "三笠食堂 / 88牛排 (辻本店)", desc: "Mikado 強棒飯離飯店近；88牛排營業至深夜 (Jack's 週三公休)", icon: "fa-utensils", link: "Steak House 88 Tsuji" }
                ]
            },
            {
                date: "01/29 (四)",
                title: "Day 2: 敘敘苑海景午餐 & 中部",
                area: "沖繩中部",
                route: "https://www.google.com/maps/dir/THE+NEST+HOTEL+NAHA/OTS+Rent-a-car+Rinku+Toyosaki/PARCO+CITY/American+Village/Aeon+Mall+Okinawa+Rycom",
                mapFocus: "PARCO CITY",
                events: [
                    { time: "08:30", title: "OTS 取車 (Prius)", desc: "前往臨空豐崎營業所", icon: "fa-car", highlight: true, alert: "important" },
                    { time: "10:00", title: "Parco City", desc: "3F 吉卜力、樂高、寶可夢中心", icon: "fa-bag-shopping", link: "PARCO CITY Urasoe West Coast" },
                    { time: "11:00", title: "敘敘苑燒肉", desc: "【已預約】窗邊座位，午間套餐CP值高", icon: "fa-fire", link: "Jojoen Parco City" },
                    { time: "14:00", title: "美國村", desc: "大國藥妝、Blue Seal 冰淇淋", icon: "fa-camera", link: "American Village Okinawa" },
                    { time: "17:00", title: "永旺夢樂城 Rycom", desc: "看超大水族箱 (視時間而定)", icon: "fa-fish" },
                    { time: "晚餐", title: "塔可飯 / A&W", desc: "Kijimuna 歐姆蛋塔可飯 或 A&W 麥根沙士", icon: "fa-burger" }
                ]
            },
            {
                date: "01/30 (五)",
                title: "Day 3: 北部遠征：鯨鯊與恐龍",
                area: "沖繩北部",
                route: "https://www.google.com/maps/dir/THE+NEST+HOTEL+NAHA/Okinawa+Churaumi+Aquarium/Kouri+Shrimp/DINO+Dinosaur+Park+Yanbaru/Motobu+Ranch",
                mapFocus: "Okinawa Churaumi Aquarium",
                events: [
                    { time: "08:00", title: "提早出發！高速公路北上", desc: "避開那霸上班車潮，車程約 2 小時", icon: "fa-road", alert: "important" },
                    { time: "10:00", title: "美麗海水族館", desc: "建議先看 10:30 戶外海豚秀，再進館看黑潮之海鯨鯊", icon: "fa-water", link: "Okinawa Churaumi Aquarium", highlight: true },
                    { time: "13:30", title: "古宇利蝦蝦飯", desc: "蒜香奶油蝦，去橋下沙灘踩水看心形岩", icon: "fa-shrimp", link: "Kouri Shrimp" },
                    { time: "15:30", title: "DINO 恐龍公園", desc: "山原亞熱帶之森，找暴龍！(名護御菓子御殿旁)", icon: "fa-dragon", link: "DINO Dinosaur Park Yanbaru Subtropical Forest" },
                    { time: "晚餐", title: "燒肉本部牧場 / 琉球之牛", desc: "和牛推薦", icon: "fa-fire", link: "Motobu Ranch" }
                ]
            },
            {
                date: "01/31 (六)",
                title: "Day 4: 南部探險 & DMM 水族館",
                area: "沖繩南部",
                route: "https://www.google.com/maps/dir/THE+NEST+HOTEL+NAHA/Gyokusendo+Cave/Itoman+Fish+Market/DMM+Kariyushi+Aquarium/OTS+Rent-a-car+Rinku+Toyosaki/Ramen+Danbo+Naha",
                mapFocus: "Okinawa World",
                events: [
                    { time: "09:30", title: "玉泉洞", desc: "日本第二大鐘乳石洞", icon: "fa-mountain", link: "Okinawa World" },
                    { time: "12:30", title: "系滿魚市場", desc: "戶外吃焗烤龍蝦、海膽，海鮮天堂", icon: "fa-fish", link: "Itoman Fish Market" },
                    { time: "14:30", title: "DMM 水族館 & iias", desc: "聲光科技互動，地板透明水槽", icon: "fa-mobile-screen", link: "DMM Kariyushi Aquarium" },
                    { time: "18:30", title: "OTS 還車", desc: "臨空豐崎營業所 (就在 iias 旁)", icon: "fa-check-circle", alert: "important" },
                    { time: "晚餐", title: "暖暮 / 通堂拉麵", desc: "回那霸市區吃拉麵", icon: "fa-bowl-rice" }
                ]
            },
            {
                date: "02/01 (日)",
                title: "Day 5: 移動日 & 鬼滅地獄巡禮",
                area: "九州別府",
                route: "https://www.google.com/maps/dir/Fukuoka+Airport/Yamada+SA/Kamado+Jigoku/Jigoku+Mushi+Kobo+Kannawa/AMANEK+Beppu+YULA-RE",
                mapFocus: "Kamado Jigoku",
                events: [
                    { time: "10:10", title: "起飛 OKA -> FUK", desc: "12:00 抵達福岡", icon: "fa-plane-departure" },
                    { time: "13:30", title: "博多取車 (Sienta)", desc: "前往別府，中途停山田 SA 買優酪乳", icon: "fa-car", highlight: true, alert: "important" },
                    { time: "16:00", title: "地獄巡禮", desc: "灶地獄 (鬼滅相關/喝溫泉水)、海地獄 (蒂芬妮藍)", icon: "fa-volcano", link: "Kamado Jigoku" },
                    { time: "晚餐", title: "地獄蒸工房 鐵輪", desc: "體驗用溫泉蒸氣蒸熟食材", icon: "fa-carrot", link: "Jigoku Mushi Kobo Kannawa" },
                    { time: "住宿", title: "AMANEK YULA-RE", desc: "頂樓無邊際溫泉泳池", icon: "fa-hotel" }
                ]
            },
            {
                date: "02/02 (一)",
                title: "Day 6: 叢林巴士 & 雪山絕景",
                area: "別府",
                route: "https://www.google.com/maps/dir/AMANEK+Beppu+YULA-RE/African+Safari/Beppu+Ropeway/Hachiman+Kamado+Shrine/Kamesho+Kururu+Sushi",
                mapFocus: "African Safari Japan",
                events: [
                    { time: "09:30", title: "九州自然動物園", desc: "【已預約】Jungle Bus 餵獅子/熊/大象", icon: "fa-paw", link: "African Safari Japan", highlight: true },
                    { time: "13:00", title: "午餐", desc: "園內餐廳 或 別府冷麵 胡月", icon: "fa-utensils" },
                    { time: "14:30", title: "別府纜車 (鶴見岳)", desc: "上山看霧冰與玩雪 (備手套帽子)", icon: "fa-snowflake", link: "Beppu Ropeway" },
                    { time: "17:00", title: "八幡竈門神社", desc: "鬼滅之刃發源地，看繪馬", icon: "fa-torii-gate", link: "Hachiman Kamado Shrine" },
                    { time: "晚餐", title: "龜正壽司 / 東洋軒", desc: "龜正不能預約，建議 17:00 前抽號碼牌", icon: "fa-fish" }
                ]
            },
            {
                date: "02/03 (二)",
                title: "Day 7: 門司港鐵道遊 & 返福岡",
                area: "北九州/福岡",
                route: "https://www.google.com/maps/dir/AMANEK+Beppu+YULA-RE/Kyushu+Railway+History+Museum/Mojiko+Retro/Hakata+Station/Richmond+Hotel+Fukuoka+Tenjin",
                mapFocus: "Mojiko Retro",
                events: [
                    { time: "09:30", title: "前往門司港", desc: "車程約 1.5 - 2 小時", icon: "fa-car" },
                    { time: "11:30", title: "九州鐵道紀念館", desc: "必玩：迷你火車駕駛體驗", icon: "fa-train", link: "Kyushu Railway History Museum" },
                    { time: "13:00", title: "午餐: 燒咖哩", desc: "Princess Phi Phi 或 Bear Fruits", icon: "fa-bowl-rice" },
                    { time: "14:30", title: "門司港懷舊區", desc: "藍翼橋開合、香蕉人合照", icon: "fa-camera", link: "Mojiko Retro" },
                    { time: "18:00", title: "博多還車", desc: "晚餐：博多一雙 (泡泡系豚骨) 或 一幸舍", icon: "fa-check", alert: "important" },
                    { time: "住宿", title: "Richmond Tenjin", desc: "入住福岡", icon: "fa-hotel" }
                ]
            },
            {
                date: "02/04 (三)",
                title: "Day 8: 科學館 & 天神購物 (無車)",
                area: "福岡天神",
                route: "https://www.google.com/maps/dir/Richmond+Hotel+Fukuoka+Tenjin/Fukuoka+City+Science+Museum/Hyotan+Sushi/Mina+Tenjin/ShinShin+Ramen+Tenjin",
                mapFocus: "Mina Tenjin",
                events: [
                    { time: "10:00", title: "福岡市科學館", desc: "六本松站。無重力訓練器、互動裝置", icon: "fa-flask", link: "Fukuoka City Science Museum" },
                    { time: "12:30", title: "葫蘆壽司 (Hyotan)", desc: "午間套餐CP值高，活車蝦/星鰻", icon: "fa-sushi", link: "Hyotan Sushi" },
                    { time: "14:30", title: "Mina Tenjin", desc: "Coca, Uniqlo, Loft (飯店對面)", icon: "fa-bag-shopping" },
                    { time: "17:00", title: "天神地下街", desc: "Bake Cheese Tart, Salut! 雜貨", icon: "fa-store" },
                    { time: "晚餐", title: "ShinShin 拉麵", desc: "天神本店，細麵清甜湯頭", icon: "fa-bowl-rice" }
                ]
            },
            {
                date: "02/05 (四)",
                title: "Day 9: 鋼彈與博多漫遊",
                area: "福岡博多",
                route: "https://www.google.com/maps/dir/Richmond+Hotel+Fukuoka+Tenjin/LaLaport+Fukuoka/Kushida+Shrine/Canal+City+Hakata/Hanamidori+Hakata+Station",
                mapFocus: "LaLaport Fukuoka",
                events: [
                    { time: "10:00", title: "LaLaport 福岡", desc: "1:1 RX-93ff 鋼彈 (整點會動)、Jump Shop", icon: "fa-robot", link: "LaLaport Fukuoka", highlight: true },
                    { time: "13:00", title: "午餐", desc: "LaLaport 美食街 (久留米拉麵/金子半之助)", icon: "fa-utensils" },
                    { time: "15:00", title: "櫛田神社", desc: "看巨大山笠，逛川端通商店街", icon: "fa-torii-gate", link: "Kushida Shrine" },
                    { time: "17:30", title: "博多運河城", desc: "看音樂水舞秀", icon: "fa-water" },
                    { time: "晚餐", title: "博多華味鳥", desc: "水炊雞肉鍋，膠原蛋白滿滿", icon: "fa-pot-food", link: "Hanamidori" }
                ]
            },
            {
                date: "02/06 (五)",
                title: "Day 10: 重返沖繩",
                area: "福岡 -> 沖繩",
                route: "https://www.google.com/maps/dir/Richmond+Hotel+Fukuoka+Tenjin/Hakata+Station/Fukuoka+Airport/Naha+Airport/THE+NEST+HOTEL+NAHA",
                mapFocus: "Hakata Station",
                events: [
                    { time: "上午", title: "睡飽 / 博多站", desc: "買努努雞 (冷炸雞) 當點心", icon: "fa-bed" },
                    { time: "午餐", title: "博多站牛舌 / 牛腸鍋", desc: "Tanya HAKATA 或 Oyama", icon: "fa-utensils" },
                    { time: "15:30", title: "前往福岡機場", desc: "國內線最後採買 (明太子仙貝)", icon: "fa-plane-departure" },
                    { time: "17:55", title: "起飛 FUK -> OKA", desc: "19:50 抵達沖繩，搭計程車回飯店", icon: "fa-plane-arrival" },
                    { time: "晚餐", title: "居酒屋 / A&W", desc: "飯店附近覓食", icon: "fa-beer" }
                ]
            },
            {
                date: "02/07 (六)",
                title: "Day 11: 牧志市場海鮮宴",
                area: "沖繩那霸",
                route: "https://www.google.com/maps/dir/THE+NEST+HOTEL+NAHA/Naminoue+Shrine/Makishi+Public+Market/Kokusai-dori/Umikaji+Terrace+Senagajima",
                mapFocus: "Makishi Public Market",
                events: [
                    { time: "10:00", title: "波上宮", desc: "海邊神社，買書包御守", icon: "fa-torii-gate", link: "Naminoue Shrine" },
                    { time: "12:00", title: "牧志公設市場", desc: "1F挑海鮮(夜光貝/刺身)，2F代客料理", icon: "fa-fish", link: "Makishi Public Market", highlight: true },
                    { time: "14:30", title: "國際通", desc: "唐吉訶德、Calbee+ 現炸薯條", icon: "fa-bag-shopping" },
                    { time: "17:00", title: "瀨長島", desc: "Umikaji Terrace 看飛機降落與夕陽", icon: "fa-plane" },
                    { time: "晚餐", title: "幸福鬆餅 / 傑克牛排", desc: "看夕陽吃鬆餅 或 回市區吃肉", icon: "fa-utensils" }
                ]
            },
            {
                date: "02/08 (日)",
                title: "Day 12: 飯糰與回家",
                area: "歸途",
                route: "https://www.google.com/maps/dir/THE+NEST+HOTEL+NAHA/Naha+Airport",
                mapFocus: "Naha Airport",
                events: [
                    { time: "09:30", title: "退房前往機場", desc: "搭計程車", icon: "fa-taxi" },
                    { time: "10:30", title: "豬肉蛋飯糰 (Potama)", desc: "國內線航廈，必吃炸蝦口味", icon: "fa-rice-cracker" },
                    { time: "11:55", title: "起飛 CI 0121", desc: "OKA -> TPE", icon: "fa-plane-departure", highlight: true }
                ]
            }
        ];

        // --- Guide Content ---
        const guideContent = [
            {
                title: "美麗海 vs DMM 水族館",
                content: `這趟旅程安排了兩個截然不同的水族館：<br><br>
                <div class="flex items-center justify-between mb-1">
                    <b class="text-journal-ink">1. 美麗海水族館 (北部)</b>
                    <button onclick="openMap('Okinawa Churaumi Aquarium')" class="btn-hand text-xs bg-white border border-journal-line px-2 py-1 rounded text-journal-brown hover:text-journal-accent transition"><i class="fa-solid fa-map-location-dot mr-1"></i>地圖</button>
                </div>
                特色是「壯闊」。擁有世界級的「黑潮之海」巨大水槽與鯨鯊，戶外有免費海豚秀與海龜館，適合欣賞大自然的宏偉。<br><br>
                <div class="flex items-center justify-between mb-1">
                    <b class="text-journal-ink">2. DMM Kariyushi 水族館 (南部)</b>
                    <button onclick="openMap('DMM Kariyushi Aquarium')" class="btn-hand text-xs bg-white border border-journal-line px-2 py-1 rounded text-journal-brown hover:text-journal-accent transition"><i class="fa-solid fa-map-location-dot mr-1"></i>地圖</button>
                </div>
                特色是「互動與科技」。結合聲光投影，地板有透明玻璃可看下方水槽，還可以近距離觸摸與餵食樹懶、水豚等動物，體驗感更強。`
            },
            {
                title: "古宇利島 (Kouri Island)",
                mapQuery: "Kouri Island",
                content: "跨越古宇利大橋，行駛在碧藍海面之上，景色絕美。<br><b>必看：</b>心形岩 (Heart Rock) 是許多廣告的拍攝地。<br><b>美食：</b>知名的 Kouri Shrimp 蝦蝦飯餐車就在島上。"
            },
            {
                title: "DINO 恐龍公園 (山原亞熱帶之森)",
                mapQuery: "DINO Dinosaur Park Yanbaru Subtropical Forest",
                content: "位於御菓子御殿名護店旁。保留了原始的筆筒樹林，並設置了許多會動會叫的恐龍模型。走在步道上彷彿進入侏羅紀公園，非常受小學生歡迎。"
            },
            {
                title: "美國村 (American Village)",
                mapQuery: "American Village Okinawa",
                content: "位於中部的北谷町，充滿美式風情的建築群。這裡有許多個性小店、咖啡廳與「Depot Island」。傍晚時分在日落海灘 (Sunset Beach) 看夕陽非常有氣氛。"
            },
            {
                title: "Parco City 浦添西海岸",
                mapQuery: "PARCO CITY Urasoe West Coast",
                content: "沖繩最大的購物商場，緊鄰西海岸，擁有絕美海景。這裡聚集了 Uniqlo、H&M、Zara 等流行品牌。對家庭客來說，3F 是重點戰區：有浦添最大的「寶可夢中心」、吉卜力「橡子共和國」以及樂高商店。"
            },
            {
                title: "沖繩世界文化王國 (玉泉洞)",
                mapQuery: "Okinawa World",
                content: "園區內的「玉泉洞」是日本第二大鐘乳石洞，全長 5 公里（開放參觀 890 公尺），景觀壯麗且終年涼爽。園區另有琉球王國村可體驗玻璃吹製等工藝。"
            },
            {
                title: "系滿魚市場",
                mapQuery: "Itoman Fish Market",
                content: "距離那霸機場不遠的海鮮天堂。這裡的海鮮價格親民，推薦購買焗烤龍蝦、海膽醬燒扇貝、生魚片，直接在戶外座位區享用。"
            },
            {
                title: "瀨長島 Umikaji Terrace",
                mapQuery: "Umikaji Terrace Senagajima",
                content: "依山而建的純白建築群，有「沖繩小希臘」之稱。這裡聚集了許多餐廳與甜點店（如幸福鬆餅）。最大的亮點是可以近距離觀看那霸機場的飛機起降。"
            },
            {
                title: "波上宮 (懸崖上的神社)",
                mapQuery: "Naminoue Shrine",
                content: "那霸市區唯一的沙灘旁，聳立在懸崖上的紅瓦神社，是沖繩八社之首。<br><b>拍照點：</b>建議走到旁邊的「波之上跨海大橋」人行道，可以拍到神社聳立在懸崖與大海之上的絕美角度。<br><b>御守：</b>這裡有可愛的書包造型御守，很適合買給小學生當護身符。"
            },
            {
                title: "牧志公設市場",
                mapQuery: "Makishi Public Market",
                content: "被稱為「那霸的廚房」。氣氛熱鬧，一樓販售色彩鮮豔的沖繩魚類、石垣牛、島  rakkyo 等食材；二樓則提供代客料理服務，是體驗在地食文化的最佳地點。"
            },
            {
                title: "九州自然動物園",
                mapQuery: "Kyushu Natural Zoological Park African Safari",
                content: "African Safari 最大的特色是可以搭乘 Jungle Bus (叢林巴士) 進入野生動物區。你可以用夾子直接餵食獅子、大象和黑熊。<br><br><b>重要提醒：</b>務必在 1/2 (一個月前) 上網預約 Jungle Bus 座位。若遇上下雪，請確認租車公司提供無釘防滑雪胎 (Studless Tires)。"
            },
            {
                title: "別府纜車 (鶴見岳)",
                mapQuery: "Beppu Ropeway",
                content: "搭乘大型纜車只需 10 分鐘即可抵達標高 1300 公尺的山頂。冬天（12月-2月）非常有機會看到樹枝上結滿「霧淞」的銀白世界，還能俯瞰整個別府灣。"
            },
            {
                title: "別府地獄巡禮精選",
                mapQuery: "Umi Jigoku",
                content: "別府有七大地獄，時間有限建議挑選 2-3 個代表性即可：<br><b>1. 海地獄 (Umi Jigoku)：</b> 必去！規模最大，泉水呈現夢幻的蒂芬妮藍 (Cobalt Blue)，庭園造景也很美。<br><b>2. 灶地獄 (Kamado Jigoku)：</b> CP值最高。一處就能看到多種顏色的溫泉，還有可以喝的溫泉水、蒸氣敷臉，且與《鬼滅之刃》炭治郎有淵源。<br><b>3. 血池地獄：</b> 泉水呈現鮮紅色，非常特別。"
            },
            {
                title: "八幡竈門神社",
                mapQuery: "Hachiman Kamado Shrine",
                content: "位於別府，因與動漫《鬼滅之刃》主角姓氏相同，且有許多傳說與劇情吻合，成為粉絲朝聖地。神社內有許多鬼滅相關的繪馬與裝飾，風景也相當清幽。"
            },
            {
                title: "九州鐵道紀念館",
                mapQuery: "Kyushu Railway History Museum",
                content: "位於門司港站旁。戶外展示了許多引退的經典火車頭。最受孩子歡迎的是「迷你鐵道公園」，可以親自駕駛迷你火車在軌道上行駛，體驗當駕駛員的樂趣。"
            },
            {
                title: "門司港懷舊區",
                mapQuery: "Mojiko Retro",
                content: "充滿大正浪漫風格的紅磚建築群。<br><b>必看：</b>門司港車站 (日本重要文化財)、藍翼橋 (整點會開合)。<br><b>必吃：</b>燒咖哩 (Baked Curry)，濃郁起司與蛋液包裹著咖哩飯，是這裡的靈魂美食。"
            },
            {
                title: "LaLaport 福岡 (實體鋼彈)",
                mapQuery: "LaLaport Fukuoka",
                content: "九州最新的購物地標。門口矗立著世界最高（24.8公尺）的 1:1 RX-93ff ν 鋼彈立像。每天整點會有頭部與手部動作的演出，晚上還有牆面投影秀。"
            },
            {
                title: "福岡市科學館",
                mapQuery: "Fukuoka City Science Museum",
                content: "位於六本松蔦屋書店樓上。館內有許多關於太空、人體、物理的互動裝置，還有最新的天象儀。設計充滿未來感，非常適合小學生寓教於樂。"
            },
            {
                title: "TeamLab Forest 福岡",
                mapQuery: "TeamLab Forest Fukuoka",
                content: "位於福岡巨蛋旁的 E-ZO FUKUOKA 內。這裡與一般的展覽不同，強調「捕捉」與「運動」。<br><b>捕捉森林：</b>下載 APP 後，可以用手機捕捉牆上的動物，非常適合小孩。<br><b>運動森林：</b>需要跳躍、踩踏的互動光影，是讓孩子放電的好地方。"
            },
            {
                title: "Mina Tenjin 購物攻略",
                mapQuery: "Mina Tenjin Fukuoka",
                content: "位於天神北側，2023年重新改裝。重點品牌集中在低樓層：<br><b>1F:</b> JINS 眼鏡、UNIQLO<br><b>2F:</b> GU (超大型店鋪)<br><b>3F:</b> <b>COCA</b> (日系平價休閒風，必逛！)<br><b>4F:</b> Loft 生活雜貨<br>飯店過馬路即達，非常方便。"
            },
            {
                title: "櫛田神社",
                mapQuery: "Kushida Shrine",
                content: "博多的總鎮守，深受在地人愛戴。這裡展示著博多祇園山笠祭使用的巨大裝飾山笠（高達十幾公尺），非常壯觀。就在川端通商店街旁，可以順路參拜。"
            },
            {
                title: "博多運河城 (Canal City)",
                mapQuery: "Canal City Hakata",
                content: "一條運河貫穿其中的大型複合商場，建築色彩繽紛。中央的太陽廣場每天定時會有音樂水舞秀，晚上配合燈光更為精彩。"
            },
            {
                title: "沖繩自駕小撇步",
                content: "1. <b>右駕：</b> 雨刷和方向燈跟台灣相反，記得口訣「靠左開」。<br>2. <b>導航：</b> 輸入 MapCode 最準確。<br>3. <b>紅綠燈：</b> 日本紅燈通常不能左轉，需等綠燈箭頭。<br>4. <b>停車：</b> 務必停在收費停車場，不可路邊違停。"
            }
        ];

        // --- Shopping Data ---
        const shoppingData = [
            {
                brand: "HOKA",
                icon: "fa-shoe-prints",
                stores: [
                    { area: "福岡", name: "HOKA Fukuoka (大名)", desc: "品牌專賣店，款式最齊全", link: "HOKA KA ONE ONE Fukuoka" },
                    { area: "沖繩", name: "ABC-MART Grand Stage", desc: "Parco City 3F / Main Place 2F", link: "ABC-MART GRAND STAGE San-A Urasoe West Coast PARCO CITY" }
                ]
            },
            {
                brand: "On Running",
                icon: "fa-cloud",
                stores: [
                    { area: "福岡", name: "ABC-MART Grand Stage", desc: "天神大名店，貨源充足", link: "ABC-MART GRAND STAGE Fukuoka Daimyo" },
                    { area: "福岡", name: "Step Sports", desc: "天神大名，專業跑鞋店", link: "Step Sports Fukuoka" },
                    { area: "沖繩", name: "Sports Depo", desc: "Parco City / 豐崎 (近Outlet)", link: "Sports Depo Ameku" }
                ]
            },
            {
                brand: "COCA",
                icon: "fa-shirt",
                stores: [
                    { area: "福岡", name: "Mina Tenjin (3F)", desc: "天神逛街必去，平價時尚", link: "Mina Tenjin Fukuoka" },
                    { area: "沖繩", name: "Parco City (2F)", desc: "沖繩旗艦店，款式多", link: "COCA Parco City" }
                ]
            }
        ];

        // --- Food Map Data ---
        const foodData = [
            {
                area: "沖繩 - 北部 (Okinawa North)",
                spots: [
                    { name: "Captain Kangaroo", type: "漢堡", icon: "fa-burger", desc: "名護人氣No.1漢堡，排隊名店", link: "Captain Kangaroo Hamburger" },
                    { name: "古宇利蝦蝦飯", type: "蝦飯", icon: "fa-shrimp", desc: "必吃蒜香奶油蝦餐車", link: "Kouri Shrimp" },
                    { name: "岸本食堂 (Kishimoto Soba)", type: "麵食", icon: "fa-bowl-rice", desc: "百年老店，木灰麵條有嚼勁", link: "Kishimoto Soba" },
                    { name: "燒肉本部牧場", type: "燒肉", icon: "fa-fire", desc: "沖繩和牛指定店", link: "Motobu Ranch" }
                ]
            },
            {
                area: "沖繩 - 中部 (Okinawa Central)",
                spots: [
                    { name: "oHacorte 港川店", type: "甜點", icon: "fa-cake-candles", desc: "外人住宅區的夢幻水果塔", link: "oHacorte Minatogawa" },
                    { name: "敘敘苑燒肉 (Parco City)", type: "燒肉", icon: "fa-fire", desc: "無敵海景燒肉，午間套餐CP值高", link: "Jojoen Parco City" },
                    { name: "A&W 漢堡 (牧港店)", type: "漢堡", icon: "fa-burger", desc: "美式風格，必喝麥根沙士", link: "A&W Makiminato" },
                    { name: "King Tacos (長田店)", type: "塔可飯", icon: "fa-bowl-rice", desc: "塔可飯創始店，份量巨大", link: "King Tacos Nagata" },
                    { name: "Taco Rice Cafe Kijimuna", type: "塔可飯", icon: "fa-bowl-rice", desc: "歐姆蛋塔可飯 (美國村)", link: "Taco Rice Cafe Kijimuna" }
                ]
            },
            {
                area: "沖繩 - 南部 (Okinawa South)",
                spots: [
                    { name: "傑克牛排 (Jack's Steak House)", type: "牛排", icon: "fa-utensils", desc: "美式老店，口感軟嫩", link: "Jack's Steak House" },
                    { name: "牧志公設市場", type: "海鮮", icon: "fa-fish", desc: "現挑現煮，夜光貝/龍蝦", link: "Makishi Public Market" },
                    { name: "豬肉蛋飯糰 (Potama)", type: "飯糰", icon: "fa-rice-cracker", desc: "那霸機場/國際通，炸蝦口味", link: "Potama Naha Airport" },
                    { name: "暖暮 / 通堂拉麵", type: "拉麵", icon: "fa-bowl-rice", desc: "沖繩人氣拉麵代表", link: "Ramen Danbo Naha" },
                    { name: "系滿魚市場", type: "海鮮", icon: "fa-fish", desc: "戶外吃焗烤龍蝦、海膽", link: "Itoman Fish Market" },
                    { name: "C&C Breakfast", type: "早午餐", icon: "fa-mug-hot", desc: "國際通人氣舒芙蕾鬆餅", link: "C&C Breakfast Okinawa" },
                    { name: "Blue Seal 冰淇淋", type: "甜點", icon: "fa-ice-cream", desc: "沖繩必吃，推薦鹽金楚糕口味", link: "Blue Seal Okinawa" }
                ]
            },
            {
                area: "九州 - 別府 & 門司港 (Beppu & Mojiko)",
                spots: [
                    { name: "東洋軒 (Toyoken)", type: "炸雞", icon: "fa-drumstick-bite", desc: "大分名物「炸雞天婦羅」發源地", link: "Toyoken Beppu" },
                    { name: "龜正迴轉壽司", type: "壽司", icon: "fa-fish", desc: "別府CP值最高，魚料超厚", link: "Kamesho Kururu Sushi" },
                    { name: "友永麵包 (Tomonaga Pan)", type: "麵包", icon: "fa-bread-slice", desc: "別府百年老店，奶油麵包", link: "Tomonaga Pan" },
                    { name: "地獄蒸工房 鐵輪", type: "體驗", icon: "fa-carrot", desc: "溫泉蒸氣蒸熟食材", link: "Jigoku Mushi Kobo Kannawa" },
                    { name: "岡本屋賣店", type: "甜點", icon: "fa-spoon", desc: "地獄蒸布丁創始店", link: "Okamotoya Shop" },
                    { name: "別府冷麵 胡月", type: "麵食", icon: "fa-bowl-rice", desc: "口感Q彈的特色冷麵", link: "Kogetsu Cold Noodles" },
                    { name: "門司港燒咖哩", type: "咖哩", icon: "fa-bowl-rice", desc: "濃郁起司焗烤，小孩最愛", link: "Mojiko Retro Grilled Curry" }
                ]
            },
            {
                area: "福岡 - 天神 (Fukuoka Tenjin)",
                spots: [
                    { name: "極味耶 (Kiwamiya)", type: "漢堡排", icon: "fa-fire", desc: "超人氣鐵板漢堡排，需排隊", link: "Kiwamiya Parco Tenjin" },
                    { name: "Full Full (天神店)", type: "麵包", icon: "fa-bread-slice", desc: "明太子法國麵包，逛街補給", link: "Full Full Tenjin" },
                    { name: "stock (Pain Stock)", type: "麵包", icon: "fa-bread-slice", desc: "福岡最強麵包店，明太子麵包", link: "stock Tenjin" },
                    { name: "葫蘆壽司 (Hyotan)", type: "壽司", icon: "fa-sushi", desc: "排隊名店，活車蝦超鮮甜", link: "Hyotan Sushi" },
                    { name: "ShinShin 拉麵", type: "拉麵", icon: "fa-bowl-rice", desc: "博多細麵，口味清甜", link: "ShinShin Ramen Tenjin" },
                    { name: "元祖博多明太重", type: "蓋飯", icon: "fa-bowl-rice", desc: "豪華整條明太子蓋飯", link: "Ganso Hakata Mentaiju" }
                ]
            },
            {
                area: "福岡 - 博多 (Fukuoka Hakata)",
                spots: [
                    { name: "Il Forno del Mignon", type: "可頌", icon: "fa-bread-slice", desc: "博多站排隊小可頌，秤重賣", link: "Il Forno del Mignon Hakata" },
                    { name: "Full Full (博多店)", type: "麵包", icon: "fa-bread-slice", desc: "近博多運河城", link: "The Full Full Hakata" },
                    { name: "Full Full (機場店)", type: "麵包", icon: "fa-bread-slice", desc: "國內線航廈，最後補貨", link: "Full Full Fukuoka Airport" },
                    { name: "博多一雙", type: "拉麵", icon: "fa-bowl-rice", desc: "泡泡系豚骨，湯頭超濃郁", link: "Hakata Issou" },
                    { name: "博多華味鳥", type: "鍋物", icon: "fa-pot-food", desc: "水炊雞肉鍋，膠原蛋白", link: "Hanamidori" },
                    { name: "牛腸鍋 Oyama", type: "鍋物", icon: "fa-pot-food", desc: "博多名物，油脂豐富", link: "Motsunabe Oyama" },
                    { name: "努努雞", type: "炸雞", icon: "fa-drumstick-bite", desc: "冰著吃的炸雞，伴手禮", link: "NuNu Chicken" }
                ]
            }
        ];

        // --- Checklist Data (Restored) ---
        const checklistData = [
            "護照 (確認效期)", "日本駕照譯本", "台灣駕照正本", "VJW 登錄 (Visit Japan Web)",
            "行動電源 & 線", "行動網卡 (eSIM)", 
            "九州租車：確認雪胎 (Studless Tires)", "預約：African Safari Jungle Bus", 
            "預約餐廳：敘敘苑, 本部牧場, 華味鳥", "保暖衣物 (九州2-10度/手套帽子)",
            "泳衣 (別府飯店用)", "信用卡 & 日幣現金"
        ];

        // --- State Management ---
        const STATE = {
            tab: 'plan',
            checklist: JSON.parse(localStorage.getItem('tripChecklist')) || {},
            memo: localStorage.getItem('tripMemo') || ""
        };

        // --- Render Functions ---

        function init() {
            render();
            // Calculate Day number based on today
            const start = new Date("2026-01-28");
            const now = new Date();
            const diffTime = now - start;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
            if(diffDays >= 1 && diffDays <= 12) {
                document.getElementById('current-day-display').innerText = diffDays;
            } else {
                 document.getElementById('current-day-display').innerText = "-";
            }
        }

        function switchTab(tabName) {
            STATE.tab = tabName;
            document.querySelectorAll('.nav-btn').forEach(btn => {
                if(btn.dataset.target === tabName) {
                    btn.classList.add('bg-journal-bg', 'text-journal-accent');
                    btn.classList.remove('text-journal-brown');
                } else {
                    btn.classList.remove('bg-journal-bg', 'text-journal-accent');
                    btn.classList.add('text-journal-brown');
                }
            });
            render();
        }

        function render() {
            const container = document.getElementById('app-container');
            container.innerHTML = ''; // Clear

            switch(STATE.tab) {
                case 'plan': renderPlan(container); break;
                case 'guide': renderGuide(container); break;
                case 'shops': renderShops(container); break;
                case 'lists': renderLists(container); break;
                case 'info': renderInfo(container); break;
            }
            window.scrollTo(0,0);
        }

        // --- Render: PLAN ---
        function renderPlan(container) {
            let html = `<div class="space-y-8 fade-in">`;
            
            tripData.forEach((day, index) => {
                const mapEmbedUrl = `https://maps.google.com/maps?q=${encodeURIComponent(day.mapFocus)}&t=&z=13&ie=UTF8&iwloc=&output=embed`;
                
                // Color Logic for days
                let tapeClass = (index < 4 || index >= 9) ? 'washi-tape-blue' : 'washi-tape-green';
                
                html += `
                    <div class="journal-card mt-4">
                        <div class="washi-tape-top ${tapeClass}"></div>
                        
                        <div class="px-5 py-4 border-b border-journal-line flex justify-between items-end bg-white rounded-t-xl">
                            <div>
                                <h3 class="font-bold text-journal-ink text-xl">${day.date}</h3>
                                <p class="text-sm text-journal-brown mt-1">${day.title}</p>
                            </div>
                            <span class="text-[10px] bg-journal-bg border border-journal-line px-2 py-1 rounded text-journal-brown font-bold tracking-wide">${day.area}</span>
                        </div>
                        
                        <!-- Map Preview -->
                        <div class="relative w-full h-32 bg-gray-100 group border-b border-journal-line border-dashed">
                            <iframe 
                                width="100%" 
                                height="100%" 
                                frameborder="0" 
                                scrolling="no" 
                                marginheight="0" 
                                marginwidth="0" 
                                src="${mapEmbedUrl}"
                                loading="lazy"
                                class="opacity-90 group-hover:opacity-100 transition-opacity pointer-events-none"
                            ></iframe>
                            <a href="${day.route}" target="_blank" class="btn-hand absolute bottom-2 right-2 bg-white/90 backdrop-blur text-journal-ink text-xs px-3 py-1.5 rounded-lg shadow-md hover:text-journal-accent flex items-center border border-journal-line">
                                <i class="fa-solid fa-diamond-turn-right mr-1.5"></i> 查看路線
                            </a>
                        </div>

                        <div class="p-5 relative">
                            <!-- Timeline -->
                `;

                day.events.forEach((event, idx) => {
                    const isLast = idx === day.events.length - 1;
                    const highlightClass = event.highlight ? 'bg-journal-bg border-journal-accent/30' : 'bg-white border-transparent';
                    const alertText = event.alert === 'important' ? 'text-journal-accent font-bold' : 'text-journal-ink';
                    const linkBtn = event.link ? `<button onclick="openMap('${event.link}')" class="mt-2 text-xs flex items-center text-journal-brown hover:text-journal-accent transition-colors"><i class="fa-solid fa-map-location-dot mr-1"></i> Google Maps</button>` : '';

                    html += `
                        <div class="relative pl-8 pb-6 ${isLast ? 'last-item' : 'timeline-line'}">
                            <div class="absolute left-0 top-0 w-8 flex justify-center">
                                <div class="w-2.5 h-2.5 rounded-full bg-journal-line border-2 border-white mt-1.5 z-10 box-content"></div>
                            </div>
                            <div class="flex items-start">
                                <span class="font-mono text-sm font-bold text-journal-brown mr-3 min-w-[45px]">${event.time}</span>
                                <div class="flex-1">
                                    <div class="flex items-center space-x-2">
                                        <i class="fa-solid ${event.icon} text-xs text-journal-brown/50"></i>
                                        <h4 class="font-medium ${alertText}">${event.title}</h4>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-1 leading-relaxed pl-5 border-l-2 border-journal-bg ml-1.5">${event.desc}</p>
                                    <div class="pl-6">${linkBtn}</div>
                                </div>
                            </div>
                        </div>
                    `;
                });

                html += `</div></div>`;
            });
            html += `</div>`;
            container.innerHTML = html;
        }

        // --- Render: SHOPS (Shopping + Food) ---
        function renderShops(container) {
             let html = `<div class="fade-in space-y-8 pb-4 relative pt-16">`; // Increased top padding
             
             // Fixed Quick Jump Menu - Lowered top position
             html += `
                <div class="fixed top-[100px] left-0 right-0 z-10 flex justify-center space-x-4 pointer-events-none">
                    <div class="bg-journal-bg/95 backdrop-blur px-4 py-2 rounded-full border border-journal-line shadow-sm pointer-events-auto flex space-x-4">
                        <button onclick="document.getElementById('section-shopping').scrollIntoView({behavior: 'smooth'})" class="px-4 py-1.5 rounded-full bg-white border border-journal-accent text-journal-accent text-xs font-bold shadow-sm active:scale-95 transition">
                            <i class="fa-solid fa-bag-shopping mr-1"></i> 必買購物
                        </button>
                        <button onclick="document.getElementById('section-food').scrollIntoView({behavior: 'smooth'})" class="px-4 py-1.5 rounded-full bg-white border border-journal-brown text-journal-brown text-xs font-bold shadow-sm active:scale-95 transition">
                            <i class="fa-solid fa-utensils mr-1"></i> 美食地圖
                        </button>
                    </div>
                </div>
             `;
             
             // Shopping Section
             html += `<div id="section-shopping" class="scroll-mt-40 journal-card p-5 border-2 border-journal-accent/20 bg-journal-bg/30">
                        <h3 class="font-bold text-journal-accent text-lg mb-4 flex items-center">
                            <i class="fa-solid fa-bag-shopping mr-2"></i> 必買購物清單
                        </h3>
                        <div class="space-y-4">`;
             
             shoppingData.forEach(brand => {
                 html += `
                    <div class="bg-white p-3 rounded-xl border border-journal-line">
                        <div class="flex items-center mb-2">
                            <div class="w-8 h-8 rounded-full bg-journal-accent/10 flex items-center justify-center text-journal-accent mr-3">
                                <i class="fa-solid ${brand.icon}"></i>
                            </div>
                            <h4 class="font-bold text-journal-ink">${brand.brand}</h4>
                        </div>
                        <div class="space-y-2 pl-11">
                            ${brand.stores.map(store => `
                                <div class="flex justify-between items-start text-xs border-b border-journal-line/30 pb-2 last:border-0 last:pb-0">
                                    <div>
                                        <span class="inline-block px-1.5 py-0.5 rounded bg-gray-100 text-gray-500 mb-1 scale-90 origin-left">${store.area}</span>
                                        <p class="font-bold text-journal-ink">${store.name}</p>
                                        <p class="text-gray-400 mt-0.5">${store.desc}</p>
                                    </div>
                                    <button onclick="openMap('${store.link}')" class="text-journal-brown hover:text-journal-accent p-2">
                                        <i class="fa-solid fa-location-arrow"></i>
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                 `;
             });
             html += `</div></div>`;

             // Food Section Header
             html += `<div id="section-food" class="scroll-mt-40"></div>`; // Adjusted scroll margin

             // Food Section Cards
             foodData.forEach(region => {
                 html += `
                    <div class="journal-card p-5">
                        <h3 class="font-bold text-journal-ink text-lg pb-3 border-b-2 border-dashed border-journal-line mb-4 flex items-center">
                            <i class="fa-solid fa-utensils text-journal-brown mr-2"></i> ${region.area}
                        </h3>
                        <div class="space-y-4">
                 `;
                 
                 region.spots.forEach(spot => {
                     html += `
                        <div class="flex justify-between items-start group">
                            <div class="flex items-start space-x-3">
                                <div class="w-8 h-8 rounded-full bg-journal-bg flex items-center justify-center text-journal-brown shrink-0 text-xs mt-0.5">
                                    <i class="fa-solid ${spot.icon}"></i>
                                </div>
                                <div>
                                    <div class="flex items-center space-x-2 flex-wrap">
                                        <h4 class="font-bold text-journal-ink text-sm">${spot.name}</h4>
                                        <span class="text-[10px] text-journal-brown bg-white border border-journal-line px-1 rounded">${spot.type}</span>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-0.5">${spot.desc}</p>
                                </div>
                            </div>
                            <button onclick="openMap('${spot.link}')" class="text-journal-line hover:text-journal-accent transition-colors p-2">
                                <i class="fa-solid fa-location-arrow text-sm"></i>
                            </button>
                        </div>
                     `;
                 });
                 
                 html += `</div></div>`;
             });

             html += `</div>`;
             container.innerHTML = html;
        }

        // --- Render: GUIDE ---
        function renderGuide(container) {
            let html = `
                <div class="fade-in space-y-6 pb-4">
                    ${guideContent.map(item => `
                        <div class="journal-card p-5 transform hover:rotate-0 transition duration-300">
                            <div class="flex justify-between items-start mb-3">
                                <h3 class="font-bold text-journal-ink text-lg border-b-4 border-journal-bg inline-block px-1">${item.title}</h3>
                                ${item.mapQuery ? 
                                    `<button onclick="openMap('${item.mapQuery}')" class="btn-hand bg-white border border-journal-line px-2 py-1 rounded text-xs text-journal-brown hover:text-journal-accent">
                                        <i class="fa-solid fa-map-location-dot mr-1"></i> 地圖
                                    </button>` : ''
                                }
                            </div>
                            <div class="text-sm leading-7 text-gray-600 font-sans">
                                ${item.content}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            container.innerHTML = html;
        }

        // --- Render: LISTS ---
        function renderLists(container) {
            let html = `
                <div class="fade-in space-y-6 pb-4">
                    <!-- CheckList -->
                    <div class="journal-card overflow-hidden">
                        <div class="bg-journal-bg px-5 py-3 border-b border-journal-line flex items-center">
                            <i class="fa-solid fa-clipboard-check text-journal-accent mr-2"></i>
                            <h3 class="font-bold text-journal-ink">行前清單</h3>
                        </div>
                        <div class="divide-y divide-journal-line/50">
                            ${checklistData.map((item, idx) => `
                                <label class="flex items-center px-5 py-3.5 cursor-pointer hover:bg-journal-bg/30 transition">
                                    <input type="checkbox" class="w-5 h-5 text-journal-accent rounded border-gray-300 focus:ring-journal-accent" 
                                        ${STATE.checklist[item] ? 'checked' : ''} 
                                        onchange="toggleCheck('${item}')">
                                    <span class="ml-3 text-sm ${STATE.checklist[item] ? 'text-gray-400 line-through' : 'text-journal-ink'}">${item}</span>
                                </label>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Memo -->
                    <div class="journal-card flex flex-col h-80 relative">
                        <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 w-8 h-8 bg-journal-line rounded-full border-4 border-journal-bg shadow-inner"></div>
                         <div class="px-5 py-4 border-b border-journal-line flex justify-between items-center bg-journal-bg/50 rounded-t-xl mt-2">
                            <h3 class="font-bold text-journal-ink">備忘錄</h3>
                            <span class="text-[10px] text-gray-400">自動儲存</span>
                        </div>
                        <textarea id="memo-area" class="flex-1 p-5 w-full resize-none focus:outline-none text-sm leading-relaxed bg-transparent" 
                            placeholder="輸入筆記、網址連結..." oninput="saveMemo(this.value)">${STATE.memo}</textarea>
                        
                        <div class="bg-journal-bg/30 px-4 py-2 border-t border-journal-line min-h-[40px] flex flex-wrap gap-2 rounded-b-xl" id="memo-links">
                            <!-- Links will appear here -->
                        </div>
                    </div>
                </div>
            `;
            container.innerHTML = html;
            updateMemoLinks(STATE.memo);
        }

        // --- Render: INFO ---
        function renderInfo(container) {
            html = `
                <div class="fade-in space-y-6 pb-4">
                    <!-- Hotel Info -->
                    <div class="journal-card p-6">
                        <h3 class="font-bold text-journal-ink mb-4 flex items-center text-lg">
                            <i class="fa-solid fa-hotel text-journal-accent mr-2"></i> 住宿資訊
                        </h3>
                        <div class="space-y-6 relative pl-2">
                            <div class="absolute left-0 top-2 bottom-2 w-0.5 bg-journal-line border-l-2 border-dashed border-journal-line"></div>
                            
                            <div class="pl-4 relative">
                                <div class="absolute -left-[21px] top-1 w-3 h-3 rounded-full bg-journal-blue border-2 border-white"></div>
                                <p class="text-[10px] text-journal-blue font-bold mb-0.5">01/28-01/31 & 02/06-02/08</p>
                                <p class="font-bold text-journal-ink text-sm">THE NEST HOTEL NAHA</p>
                                <button onclick="openMap('THE NEST HOTEL NAHA')" class="mt-1 text-xs text-gray-400 hover:text-journal-accent transition flex items-center">
                                    <i class="fa-solid fa-location-dot mr-1"></i> 那霸
                                </button>
                            </div>
                            
                            <div class="pl-4 relative">
                                <div class="absolute -left-[21px] top-1 w-3 h-3 rounded-full bg-journal-green border-2 border-white"></div>
                                <p class="text-[10px] text-journal-green font-bold mb-0.5">02/01 - 02/03</p>
                                <p class="font-bold text-journal-ink text-sm">AMANEK Beppu YULA-RE</p>
                                <button onclick="openMap('AMANEK Beppu YULA-RE')" class="mt-1 text-xs text-gray-400 hover:text-journal-accent transition flex items-center">
                                    <i class="fa-solid fa-location-dot mr-1"></i> 別府
                                </button>
                            </div>

                            <div class="pl-4 relative">
                                <div class="absolute -left-[21px] top-1 w-3 h-3 rounded-full bg-journal-brown border-2 border-white"></div>
                                <p class="text-[10px] text-journal-brown font-bold mb-0.5">02/03 - 02/05</p>
                                <p class="font-bold text-journal-ink text-sm">Richmond Hotel Fukuoka Tenjin</p>
                                <button onclick="openMap('Richmond Hotel Fukuoka Tenjin')" class="mt-1 text-xs text-gray-400 hover:text-journal-accent transition flex items-center">
                                    <i class="fa-solid fa-location-dot mr-1"></i> 福岡
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Flight Info -->
                    <div class="journal-card p-6">
                        <h3 class="font-bold text-journal-ink mb-4 flex items-center text-lg">
                            <i class="fa-solid fa-plane text-journal-accent mr-2"></i> 航班行程
                        </h3>
                        <div class="space-y-4">
                            <div class="bg-journal-bg rounded-lg p-3 border border-journal-line/50">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="font-bold text-journal-ink text-sm">01/28</span>
                                    <span class="text-xs text-white bg-journal-blue px-2 py-0.5 rounded-full">去程</span>
                                </div>
                                <div class="flex justify-between text-xs text-gray-500">
                                    <span>16:50 TPE <i class="fa-solid fa-arrow-right mx-1"></i> 19:20 OKA</span>
                                    <span class="font-mono">CI 0122</span>
                                </div>
                            </div>
                            <div class="bg-journal-bg rounded-lg p-3 border border-journal-line/50">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="font-bold text-journal-ink text-sm">02/01</span>
                                    <span class="text-xs text-white bg-journal-green px-2 py-0.5 rounded-full">國內</span>
                                </div>
                                <div class="flex justify-between text-xs text-gray-500">
                                    <span>10:10 OKA <i class="fa-solid fa-arrow-right mx-1"></i> 12:00 FUK</span>
                                    <span class="font-mono">MM282</span>
                                </div>
                            </div>
                            <div class="bg-journal-bg rounded-lg p-3 border border-journal-line/50">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="font-bold text-journal-ink text-sm">02/06</span>
                                    <span class="text-xs text-white bg-journal-green px-2 py-0.5 rounded-full">國內</span>
                                </div>
                                <div class="flex justify-between text-xs text-gray-500">
                                    <span>17:55 FUK <i class="fa-solid fa-arrow-right mx-1"></i> 19:50 OKA</span>
                                    <span class="font-mono">MM289</span>
                                </div>
                            </div>
                             <div class="bg-journal-bg rounded-lg p-3 border border-journal-line/50">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="font-bold text-journal-ink text-sm">02/08</span>
                                    <span class="text-xs text-white bg-journal-accent px-2 py-0.5 rounded-full">回程</span>
                                </div>
                                <div class="flex justify-between text-xs text-gray-500">
                                    <span>11:55 OKA <i class="fa-solid fa-arrow-right mx-1"></i> 12:35 TPE</span>
                                    <span class="font-mono">CI 0121</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Rental Car Info -->
                    <div class="journal-card p-6">
                        <h3 class="font-bold text-journal-ink mb-4 flex items-center text-lg">
                            <i class="fa-solid fa-car text-journal-accent mr-2"></i> 租車資訊
                        </h3>
                        <div class="space-y-6">
                            <!-- OTS Okinawa -->
                            <div class="relative bg-journal-bg/30 p-4 rounded-xl border border-dashed border-journal-line">
                                <div class="absolute -top-2 left-4 px-2 bg-white text-xs text-journal-blue font-bold border border-journal-line rounded">沖繩</div>
                                <div class="flex justify-between items-start mt-1">
                                    <p class="font-bold text-journal-ink text-sm">OTS Rent-a-car</p>
                                    <span class="bg-white text-journal-accent text-[10px] px-2 py-1 rounded border border-journal-line">當地支付</span>
                                </div>
                                
                                <div class="mt-3 text-xs text-gray-600 space-y-2 font-mono">
                                    <div class="flex justify-between">
                                        <span class="text-gray-400">預約號碼</span>
                                        <span class="font-bold text-base text-journal-ink">OTS1382312</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-400">取還時間</span>
                                        <span>01/29 08:30 - 01/31 19:00</span>
                                    </div>
                                    <div class="flex justify-between border-t border-dashed border-journal-line pt-2">
                                        <span class="text-gray-400">支付金額</span>
                                        <span class="font-bold">¥23,130</span>
                                    </div>
                                </div>
                                <button onclick="openMap('OTS Rent-a-car Rinku Toyosaki')" class="btn-hand mt-3 w-full py-2 bg-white rounded-lg border border-journal-line text-xs text-journal-brown hover:text-journal-accent transition">
                                    <i class="fa-solid fa-location-arrow mr-1.5"></i> 導航至臨空豐崎
                                </button>
                            </div>

                            <!-- Toyota Fukuoka -->
                            <div class="relative bg-journal-bg/30 p-4 rounded-xl border border-dashed border-journal-line">
                                <div class="absolute -top-2 left-4 px-2 bg-white text-xs text-journal-green font-bold border border-journal-line rounded">九州</div>
                                <div class="flex justify-between items-start mt-1">
                                    <p class="font-bold text-journal-ink text-sm">TOYOTA Rent a Car</p>
                                    <span class="bg-white text-journal-brown text-[10px] px-2 py-1 rounded border border-journal-line">已結算</span>
                                </div>
                                
                                <div class="mt-3 text-xs text-gray-600 space-y-2 font-mono">
                                    <div class="flex justify-between">
                                        <span class="text-gray-400">預約號碼</span>
                                        <span class="font-bold text-base text-journal-ink">99903633500</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-400">取還時間</span>
                                        <span>02/01 13:30 - 02/03 18:00</span>
                                    </div>
                                    <div class="flex justify-between border-t border-dashed border-journal-line pt-2">
                                        <span class="text-gray-400">結算金額</span>
                                        <span class="font-bold">¥47,932</span>
                                    </div>
                                </div>
                                <button onclick="openMap('Toyota Rent a Car Fukuoka Airport')" class="btn-hand mt-3 w-full py-2 bg-white rounded-lg border border-journal-line text-xs text-journal-brown hover:text-journal-accent transition">
                                    <i class="fa-solid fa-location-arrow mr-1.5"></i> 導航至福岡機場店
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Weather & Emergency Numbers -->
                    <div class="grid grid-cols-2 gap-4">
                         <a href="https://www.jma.go.jp/bosai/forecast/" target="_blank" class="journal-card p-4 flex flex-col items-center justify-center space-y-2 hover:bg-journal-bg/50 transition cursor-pointer">
                            <i class="fa-solid fa-cloud-sun text-3xl text-journal-blue"></i>
                            <span class="font-bold text-journal-ink text-sm">天氣預報</span>
                        </a>
                        <div class="journal-card p-4 flex flex-col items-center justify-center space-y-2">
                             <i class="fa-solid fa-phone-volume text-3xl text-journal-accent"></i>
                            <span class="font-bold text-journal-ink text-sm">緊急: 110 / 119</span>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow-sm border border-journal-line p-5">
                        <h3 class="font-bold text-journal-ink mb-3 text-sm">緊急聯絡 (TECO)</h3>
                        <ul class="space-y-3 text-sm text-gray-600">
                            <li class="flex items-center"><i class="fa-solid fa-phone w-6 text-journal-accent"></i> 福岡急難：090-1922-9740</li>
                             <li class="flex items-center"><i class="fa-solid fa-phone w-6 text-journal-accent"></i> 那霸急難：090-1942-1107</li>
                        </ul>
                    </div>
                </div>
            `;
            container.innerHTML = html;
        }

        // Start
        init();
        switchTab('plan'); // Init Tab

        function openMap(query) {
            window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query)}`, '_blank');
        }
        function toggleCheck(item) {
            STATE.checklist[item] = !STATE.checklist[item];
            localStorage.setItem('tripChecklist', JSON.stringify(STATE.checklist));
            renderLists(document.getElementById('app-container'));
        }
        function saveMemo(val) {
            STATE.memo = val;
            localStorage.setItem('tripMemo', val);
            updateMemoLinks(val);
        }
        function updateMemoLinks(text) {
            const container = document.getElementById('memo-links');
            if(!container) return;
            const urlRegex = /(https?:\/\/[^\s]+)/g;
            const matches = text.match(urlRegex);
            if(matches) {
                container.innerHTML = matches.map(url => `
                    <a href="${url}" target="_blank" class="inline-flex items-center px-2 py-1 bg-white border border-journal-line rounded text-[10px] text-journal-blue truncate max-w-[150px]">
                        <i class="fa-solid fa-link mr-1"></i> 連結
                    </a>
                `).join('');
            } else { container.innerHTML = ''; }
        }

    </script>
</body>
</html>
